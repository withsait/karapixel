# ğŸ—ï¸ KaraPixel - AltyapÄ± DokÃ¼mantasyonu

> Sunucu kurulumu, yapÄ±landÄ±rmasÄ± ve yÃ¶netimi.

---

## DonanÄ±m SpesifikasyonlarÄ±

### Ana Sunucu (Dedicated)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   HETZNER DEDICATED SERVER                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODEL        : Hetzner Auction (Ryzen 9 5950X)                â”‚
â”‚  CPU          : AMD Ryzen 9 5950X                              â”‚
â”‚                16 Core / 32 Thread                             â”‚
â”‚                3.4 GHz Base / 4.9 GHz Boost                    â”‚
â”‚  RAM          : 128 GB DDR4 ECC                                â”‚
â”‚  STORAGE      : 2x 3.84 TB NVMe SSD (RAID 1)                  â”‚
â”‚  NETWORK      : 1 Gbit/s (Dedicated)                          â”‚
â”‚  DDoS         : Hetzner DDoS Protection (Included)            â”‚
â”‚  LOCATION     : FSN (Falkenstein, Germany)                    â”‚
â”‚  OS           : Ubuntu 24.04 LTS                              â”‚
â”‚  COST         : ~â‚¬68.70/ay                                    â”‚
â”‚                                                                 â”‚
â”‚  IP           : (SipariÅŸ sonrasÄ± atanacak)                    â”‚
â”‚  HOSTNAME     : kp-game-01.karapixel.net                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Hyble-Core VPS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HETZNER CLOUD VPS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODEL        : CX32                                           â”‚
â”‚  CPU          : 4 vCPU (AMD EPYC)                             â”‚
â”‚  RAM          : 8 GB                                           â”‚
â”‚  STORAGE      : 80 GB NVMe SSD                                â”‚
â”‚  NETWORK      : 20 TB Traffic                                  â”‚
â”‚  LOCATION     : FSN (Falkenstein, Germany)                    â”‚
â”‚  OS           : Ubuntu 24.04.3 LTS                            â”‚
â”‚  COST         : â‚¬15.59/ay                                     â”‚
â”‚                                                                 â”‚
â”‚  IP           : 159.69.42.124                                 â”‚
â”‚  HOSTNAME     : hyble-core                                     â”‚
â”‚  PURPOSE      : Hyble services (web, api, billing)            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Storage Box (Backup)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   HETZNER STORAGE BOX                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  MODEL        : BX10                                           â”‚
â”‚  CAPACITY     : 1 TB                                           â”‚
â”‚  PROTOCOL     : SFTP, SCP, rsync, Samba, WebDAV               â”‚
â”‚  SNAPSHOTS    : 10 included                                    â”‚
â”‚  COST         : â‚¬3.81/ay                                      â”‚
â”‚                                                                 â”‚
â”‚  HOST         : uXXXXXX.your-storagebox.de                    â”‚
â”‚  PORT         : 23 (SSH/SFTP)                                 â”‚
â”‚  PURPOSE      : Off-site backup storage                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Dizin YapÄ±sÄ±

### Game Server Dizin YapÄ±sÄ±

```
/opt/karapixel/
â”œâ”€â”€ servers/
â”‚   â”œâ”€â”€ velocity/
â”‚   â”‚   â”œâ”€â”€ velocity.jar
â”‚   â”‚   â”œâ”€â”€ velocity.toml
â”‚   â”‚   â”œâ”€â”€ server-icon.png
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ Geyser-Velocity.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ floodgate-velocity.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-velocity.jar
â”‚   â”‚   â”‚   â””â”€â”€ LuckPerms-Velocity.jar
â”‚   â”‚   â”œâ”€â”€ logs/
â”‚   â”‚   â””â”€â”€ forwarding.secret
â”‚   â”‚
â”‚   â”œâ”€â”€ limbo/
â”‚   â”‚   â”œâ”€â”€ karapaper.jar
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ karapaper.yml
â”‚   â”‚   â”‚   â”œâ”€â”€ bukkit.yml
â”‚   â”‚   â”‚   â”œâ”€â”€ spigot.yml
â”‚   â”‚   â”‚   â””â”€â”€ paper-global.yml
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-core.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-auth.jar
â”‚   â”‚   â”‚   â””â”€â”€ karapixel-ui.jar
â”‚   â”‚   â”œâ”€â”€ world/
â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚
â”‚   â”œâ”€â”€ hub/
â”‚   â”‚   â”œâ”€â”€ karapaper.jar
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-core.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-hub.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-selector.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-cosmetics.jar
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ world/
â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚
â”‚   â”œâ”€â”€ skyblock-spawn/           # 20GB RAM
â”‚   â”‚   â”œâ”€â”€ karapaper.jar
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-core.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-skyblock.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-economy.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-shop.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-crates.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-events.jar      # BalÄ±k event vb.
â”‚   â”‚   â”‚   â”œâ”€â”€ ModelEngine.jar
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ world/
â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚
â”‚   â”œâ”€â”€ pvp-arena/                # 6GB RAM (YENÄ°)
â”‚   â”‚   â”œâ”€â”€ karapaper.jar
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-core.jar
â”‚   â”‚   â”‚   â”œâ”€â”€ karapixel-pvp.jar
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ world/
â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚
â”‚   â”œâ”€â”€ skyblock-1/               # 24GB RAM
â”‚   â”‚   â”œâ”€â”€ karapaper.jar
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ plugins/
â”‚   â”‚   â”œâ”€â”€ world/                # Ada world'Ã¼
â”‚   â”‚   â””â”€â”€ logs/
â”‚   â”‚
â”‚   â”œâ”€â”€ skyblock-2/               # 24GB RAM
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ skyblock-3/               # 16GB RAM (RESERVE)
â”‚   â”‚   â””â”€â”€ ... (gerektiÄŸinde aktif)
â”‚   â”‚
â”‚   â””â”€â”€ nether-end/               # 10GB RAM (YENÄ° - PaylaÅŸÄ±mlÄ±)
â”‚       â”œâ”€â”€ karapaper.jar
â”‚       â”œâ”€â”€ config/
â”‚       â”œâ”€â”€ plugins/
â”‚       â”œâ”€â”€ world_nether/
â”‚       â”œâ”€â”€ world_the_end/
â”‚       â””â”€â”€ logs/
â”‚
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ plugins/           # TÃ¼m sunucularda ortak pluginler
â”‚   â”œâ”€â”€ configs/           # Ortak konfigÃ¼rasyonlar
â”‚   â””â”€â”€ resourcepack/      # Resource pack
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ start-all.sh
â”‚   â”œâ”€â”€ stop-all.sh
â”‚   â”œâ”€â”€ restart-server.sh
â”‚   â”œâ”€â”€ backup-database.sh
â”‚   â”œâ”€â”€ backup-worlds.sh
â”‚   â”œâ”€â”€ update-plugins.sh
â”‚   â””â”€â”€ health-check.sh
â”‚
â”œâ”€â”€ backups/
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ worlds/
â”‚   â””â”€â”€ configs/
â”‚
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ access.log
â”‚   â”œâ”€â”€ error.log
â”‚   â””â”€â”€ security.log
â”‚
â””â”€â”€ data/
    â”œâ”€â”€ mysql/             # MySQL data dir
    â””â”€â”€ redis/             # Redis data dir
```

---

## Servis Kurulumu

### Java 21 Kurulumu

```bash
# Java 21 (OpenJDK)
sudo apt update
sudo apt install -y openjdk-21-jdk

# Verify
java -version

# JAVA_HOME ayarla
echo 'export JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64' >> ~/.bashrc
source ~/.bashrc
```

### MySQL 8 Kurulumu

```bash
# MySQL 8 kurulumu
sudo apt install -y mysql-server

# GÃ¼venlik ayarlarÄ±
sudo mysql_secure_installation

# Database ve kullanÄ±cÄ± oluÅŸtur
sudo mysql -u root -p << EOF
CREATE DATABASE karapixel_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'karapixel'@'localhost' IDENTIFIED BY 'STRONG_PASSWORD_HERE';
GRANT ALL PRIVILEGES ON karapixel_db.* TO 'karapixel'@'localhost';
FLUSH PRIVILEGES;
EOF

# Performans ayarlarÄ±
sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
```

```ini
# /etc/mysql/mysql.conf.d/mysqld.cnf
[mysqld]
# InnoDB ayarlarÄ±
innodb_buffer_pool_size = 6G
innodb_log_file_size = 512M
innodb_flush_log_at_trx_commit = 2
innodb_flush_method = O_DIRECT

# BaÄŸlantÄ± limitleri
max_connections = 500
wait_timeout = 600
interactive_timeout = 600

# Query cache (MySQL 8'de deprecated)
# Performance schema
performance_schema = ON

# Logging
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2
```

### Redis Kurulumu

```bash
# Redis kurulumu
sudo apt install -y redis-server

# KonfigÃ¼rasyon
sudo nano /etc/redis/redis.conf
```

```ini
# /etc/redis/redis.conf
bind 127.0.0.1
port 6379

# Åifre
requirepass STRONG_REDIS_PASSWORD

# Memory
maxmemory 4gb
maxmemory-policy allkeys-lru

# Persistence
save 900 1
save 300 10
save 60 10000

# Security
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command DEBUG ""
```

```bash
# Redis baÅŸlat
sudo systemctl enable redis-server
sudo systemctl start redis-server
```

---

## Systemd Servisleri

### Velocity Proxy Servisi

```ini
# /etc/systemd/system/velocity.service
[Unit]
Description=KaraPixel Velocity Proxy
After=network.target

[Service]
User=minecraft
Group=minecraft
WorkingDirectory=/opt/karapixel/servers/velocity

ExecStart=/usr/bin/java \
    -Xms3G -Xmx3G \
    -XX:+UseG1GC \
    -XX:G1HeapRegionSize=4M \
    -XX:+UnlockExperimentalVMOptions \
    -XX:+ParallelRefProcEnabled \
    -XX:+AlwaysPreTouch \
    -Dlog4j2.formatMsgNoLookups=true \
    -jar velocity.jar

Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### Game Server Servisi (Template)

```ini
# /etc/systemd/system/karapixel@.service
[Unit]
Description=KaraPixel %i Server
After=network.target mysql.service redis.service

[Service]
User=minecraft
Group=minecraft
WorkingDirectory=/opt/karapixel/servers/%i

ExecStart=/usr/bin/java \
    -Xms${MEMORY} -Xmx${MEMORY} \
    -XX:+UseG1GC \
    -XX:+ParallelRefProcEnabled \
    -XX:MaxGCPauseMillis=200 \
    -XX:+UnlockExperimentalVMOptions \
    -XX:+DisableExplicitGC \
    -XX:+AlwaysPreTouch \
    -XX:G1NewSizePercent=30 \
    -XX:G1MaxNewSizePercent=40 \
    -XX:G1HeapRegionSize=8M \
    -XX:G1ReservePercent=20 \
    -XX:G1HeapWastePercent=5 \
    -XX:G1MixedGCCountTarget=4 \
    -XX:InitiatingHeapOccupancyPercent=15 \
    -XX:G1MixedGCLiveThresholdPercent=90 \
    -XX:G1RSetUpdatingPauseTimePercent=5 \
    -XX:SurvivorRatio=32 \
    -XX:+PerfDisableSharedMem \
    -XX:MaxTenuringThreshold=1 \
    -Dlog4j2.formatMsgNoLookups=true \
    -Daikars.new.flags=true \
    -jar karapaper.jar --nogui

Restart=always
RestartSec=10

EnvironmentFile=/opt/karapixel/servers/%i/server.env

[Install]
WantedBy=multi-user.target
```

### Environment Files

```bash
# /opt/karapixel/servers/hub/server.env
MEMORY=6G

# /opt/karapixel/servers/skyblock-spawn/server.env
MEMORY=20G

# /opt/karapixel/servers/pvp-arena/server.env
MEMORY=6G

# /opt/karapixel/servers/skyblock-1/server.env
MEMORY=24G

# /opt/karapixel/servers/skyblock-2/server.env
MEMORY=24G

# /opt/karapixel/servers/nether-end/server.env
MEMORY=10G

# NOT: skyblock-3 reserve'de, gerektiÄŸinde aktif edilecek
# /opt/karapixel/servers/skyblock-3/server.env (RESERVE)
# MEMORY=16G (reserve'den tahsis edilecek)
```

### Servis YÃ¶netimi

```bash
# Servisleri etkinleÅŸtir
sudo systemctl enable velocity
sudo systemctl enable karapixel@hub
sudo systemctl enable karapixel@limbo
sudo systemctl enable karapixel@skyblock-spawn
sudo systemctl enable karapixel@pvp-arena
sudo systemctl enable karapixel@skyblock-1
sudo systemctl enable karapixel@skyblock-2
sudo systemctl enable karapixel@nether-end
# skyblock-3 reserve'de - gerektiÄŸinde enable edilecek

# BaÅŸlat
sudo systemctl start velocity
sudo systemctl start karapixel@hub

# Durum kontrol
sudo systemctl status karapixel@hub

# Log izle
sudo journalctl -u karapixel@hub -f
```

---

## BaÅŸlatma Scriptleri

### start-all.sh

```bash
#!/bin/bash
# /opt/karapixel/scripts/start-all.sh

echo "Starting KaraPixel servers..."

# SÄ±ralÄ± baÅŸlatma (baÄŸÄ±mlÄ±lÄ±k sÄ±rasÄ±na gÃ¶re)
echo "Starting Velocity..."
sudo systemctl start velocity
sleep 5

echo "Starting Limbo..."
sudo systemctl start karapixel@limbo
sleep 5

echo "Starting Hub..."
sudo systemctl start karapixel@hub
sleep 5

echo "Starting Skyblock Spawn..."
sudo systemctl start karapixel@skyblock-spawn
sleep 5

echo "Starting PvP Arena..."
sudo systemctl start karapixel@pvp-arena
sleep 3

echo "Starting Skyblock Worlds..."
sudo systemctl start karapixel@skyblock-1
sudo systemctl start karapixel@skyblock-2
sleep 3

echo "Starting Nether/End..."
sudo systemctl start karapixel@nether-end

# NOT: skyblock-3 reserve'de, manuel baÅŸlatÄ±lacak
# sudo systemctl start karapixel@skyblock-3

echo "All servers started!"

# Durum kontrolÃ¼
sleep 10
./health-check.sh
```

### stop-all.sh

```bash
#!/bin/bash
# /opt/karapixel/scripts/stop-all.sh

echo "Stopping KaraPixel servers..."

# Ters sÄ±rada durdur
echo "Stopping Nether/End..."
sudo systemctl stop karapixel@nether-end

echo "Stopping Skyblock Worlds..."
sudo systemctl stop karapixel@skyblock-1
sudo systemctl stop karapixel@skyblock-2
# sudo systemctl stop karapixel@skyblock-3  # Reserve

echo "Stopping PvP Arena..."
sudo systemctl stop karapixel@pvp-arena

echo "Stopping Skyblock Spawn..."
sudo systemctl stop karapixel@skyblock-spawn

echo "Stopping Hub..."
sudo systemctl stop karapixel@hub

echo "Stopping Limbo..."
sudo systemctl stop karapixel@limbo

echo "Stopping Velocity..."
sudo systemctl stop velocity

echo "All servers stopped!"
```

### health-check.sh

```bash
#!/bin/bash
# /opt/karapixel/scripts/health-check.sh

echo "=== KaraPixel Health Check ==="
echo ""

check_service() {
    local name=$1
    local port=$2
    
    if systemctl is-active --quiet $name; then
        echo "âœ… $name: Running"
        
        if [ ! -z "$port" ]; then
            if nc -z localhost $port 2>/dev/null; then
                echo "   Port $port: Open"
            else
                echo "   Port $port: âš ï¸ Not responding"
            fi
        fi
    else
        echo "âŒ $name: Stopped"
    fi
}

check_service "velocity" "25565"
check_service "karapixel@limbo" "25566"
check_service "karapixel@hub" "25567"
check_service "karapixel@skyblock-spawn" "25568"
check_service "karapixel@pvp-arena" "25569"
check_service "karapixel@skyblock-1" "25570"
check_service "karapixel@skyblock-2" "25571"
check_service "karapixel@nether-end" "25572"
# check_service "karapixel@skyblock-3" "25573"  # Reserve

echo ""
echo "=== Resource Usage ==="
echo "CPU: $(top -bn1 | grep "Cpu(s)" | awk '{print $2}')%"
echo "RAM: $(free -h | grep Mem | awk '{print $3 "/" $2}')"
echo "Disk: $(df -h /opt/karapixel | tail -1 | awk '{print $3 "/" $2 " (" $5 ")"}')"

echo ""
echo "=== Database Status ==="
if systemctl is-active --quiet mysql; then
    echo "âœ… MySQL: Running"
else
    echo "âŒ MySQL: Stopped"
fi

if systemctl is-active --quiet redis-server; then
    echo "âœ… Redis: Running"
else
    echo "âŒ Redis: Stopped"
fi

echo ""
echo "=== RAM Allocation ==="
echo "Spawn: 20GB | PvP: 6GB | World1: 24GB | World2: 24GB | Nether: 10GB"
echo "Reserve: 16GB (3. World iÃ§in hazÄ±r)"
```

---

## Port YapÄ±landÄ±rmasÄ±

| Servis | Port | Protokol | RAM | AÃ§Ä±klama |
|--------|------|----------|-----|----------|
| Velocity | 25565 | TCP | 3GB | Java Minecraft |
| Geyser | 19132 | UDP | 2GB | Bedrock Minecraft |
| Limbo | 25566 | TCP | 1GB | Authentication |
| Hub | 25567 | TCP | 6GB | Main Lobby |
| Skyblock Spawn | 25568 | TCP | 20GB | Market, Event, NPC |
| PvP Arena | 25569 | TCP | 6GB | Combat Server |
| Skyblock #1 | 25570 | TCP | 24GB | Island World |
| Skyblock #2 | 25571 | TCP | 24GB | Island World |
| Nether/End | 25572 | TCP | 10GB | Shared Dimension |
| Skyblock #3 | 25573 | TCP | 16GB* | Reserve (gerekirse) |
| MySQL | 3306 | TCP | 8GB | localhost only |
| Redis | 6379 | TCP | 4GB | localhost only |
| SSH | 22 | TCP | - | Admin access |

*Reserve'den tahsis edilecek

### Firewall KurallarÄ±

```bash
# UFW kurallarÄ±
sudo ufw default deny incoming
sudo ufw default allow outgoing

# SSH
sudo ufw allow 22/tcp

# Minecraft
sudo ufw allow 25565/tcp   # Java
sudo ufw allow 19132/udp   # Bedrock

# Internal sunuculara dÄ±ÅŸarÄ±dan eriÅŸim YOK
# 25566-25571 portlarÄ± sadece localhost

sudo ufw enable
```

---

## DNS YapÄ±landÄ±rmasÄ±

### Cloudflare DNS

| Subdomain | Type | Value | Proxy |
|-----------|------|-------|-------|
| karapixel.net | A | GAME_SERVER_IP | âŒ |
| play.karapixel.net | A | GAME_SERVER_IP | âŒ |
| www.karapixel.net | A | WEB_VPS_IP | âœ… |
| api.karapixel.net | A | WEB_VPS_IP | âœ… |
| panel.karapixel.net | A | GAME_SERVER_IP | âŒ |

> âš ï¸ **Ã–NEMLÄ°:** Minecraft portlarÄ± Cloudflare proxy'den geÃ§memeli!

### SRV Record (Opsiyonel)

```
_minecraft._tcp.karapixel.net  SRV  0 5 25565 play.karapixel.net
```

---

## Monitoring

### Prometheus + Grafana

```yaml
# /opt/karapixel/monitoring/prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'minecraft'
    static_configs:
      - targets:
        - 'localhost:9100'  # Node exporter
        - 'localhost:9225'  # Minecraft exporter (Hub)
        - 'localhost:9226'  # Minecraft exporter (Skyblock-1)
```

### Alert Rules

```yaml
# /opt/karapixel/monitoring/alerts.yml
groups:
  - name: minecraft
    rules:
      - alert: ServerDown
        expr: up{job="minecraft"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Minecraft server down"
          
      - alert: HighTPS
        expr: minecraft_tps < 18
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "TPS dropped below 18"
          
      - alert: HighMemory
        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes > 0.9
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Memory usage above 90%"
```

---

*ğŸ“… Son gÃ¼ncelleme: 24 AralÄ±k 2024 - SeÃ§enek B (20GB Spawn, 2 World + Reserve) onaylandÄ±*
